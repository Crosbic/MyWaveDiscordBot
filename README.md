# MyWaveDiscordBot

- Авторизация через Яндекс Музыку
- Воспроизведение персонализированной станции "Моя волна"
- Автоматическое воспроизведение следующих треков
- Отображение информации о текущем треке

## Установка

1. Клонируйте репозиторий:

   ```
   git clone https://github.com/Crosbic/MyWaveDiscordBot.git
   cd MyWaveDiscordBot
   ```

2. Установите зависимости:

   ```
   yarn install
   ```

3. Создайте файл `.env` на основе `.env.template`:

   ```
   cp .env.template .env
   ```

4. Заполните файл `.env` необходимыми данными:

   ```
   # Токен Discord бота
   DISCORD_TOKEN=ваш_токен

   # ID клиента (приложения)
   CLIENT_ID=ваш_id

   # ID сервера для разработки если нужен
   DEV_GUILD_ID=ваш_id_сервера_для_разработки

   # Список ID или username администраторов бота, через запятую
   ADMINS=user1,user2
   ```

5. Зарегистрируйте команды бота:

   ```
   yarn deploy
   ```

6. Запустите бота в режиме разработки:
   ```
   yarn dev
   ```

## Команды

| Команда                    | Описание                                             |
| -------------------------- | ---------------------------------------------------- |
| `/login-help`              | Получить инструкции по авторизации через Яндекс      |
| `/login <token>`           | Авторизация через Яндекс, используя токен            |
| `/logout`                  | Выход из аккаунта Яндекс                             |
| `/my-wave`                 | Воспроизвести треки из "Моя волна" в Яндекс Музыке   |
| `/account-info`            | Показать информацию о подключенном аккаунте Яндекс   |
| `/allow-buttons <enabled>` | Включить/выключить публичный доступ к кнопкам плеера |

### Авторизация через Яндекс Музыку

1. Используйте команду `/login-help` для получения инструкций по авторизации
2. Перейдите по предоставленной ссылке и авторизуйтесь в Яндексе
3. После авторизации скопируйте токен из URL
4. Используйте команду `/login <ваш_токен>` для завершения авторизации

### Воспроизведение музыки

1. Подключитесь к голосовому каналу
2. Используйте команду `/my-wave` для начала воспроизведения вашей персонализированной станции
3. Бот автоматически будет воспроизводить следующие треки

### Настройка публичного доступа к управлению плеером

По умолчанию только пользователь, запустивший воспроизведение, может управлять плеером (нажимать кнопки паузы, следующего трека и т.д.). Администраторы сервера могут включить публичный доступ к кнопкам плеера:

1. Используйте команду `/allow-buttons true` для включения публичного доступа
2. Используйте команду `/allow-buttons false` для выключения публичного доступа

Доступ к этой команде имеют:

- Администраторы сервера
- Пользователи, указанные в параметре `ADMINS` в файле `.env`

**Важно**: Если публичный доступ включен, пользователи должны находиться в том же голосовом канале, что и бот, чтобы иметь возможность управлять плеером. Администраторы из списка `ADMINS` могут управлять плеером из любого канала.

## Примечания

- Для использования бота требуется активная подписка Яндекс Плюс
- Токен Яндекс действителен в течение года
- Бот может воспроизводить музыку только в голосовых каналах, к которым у него есть доступ

## Лицензия

MyWaveDiscordBot или его разработчик не связаны с Яндексом или какой-либо из их компаний, сотрудников и т.д.

Этот проект распространяется под лицензией MIT. Подробности смотрите в файле LICENSE.
